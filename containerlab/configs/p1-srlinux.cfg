# P1 SR Linux Core Configuration
# Core P router for MPLS/BGP backbone

set / system information location "AURORA-IBN Core P Router"
set / system information contact "Aurora IBN Controller"

# Management interface
set / interface mgmt0 admin-state enable
set / interface mgmt0 subinterface 0 admin-state enable
set / interface mgmt0 subinterface 0 ipv4 dhcp-client

# Loopback
set / interface lo0 admin-state enable
set / interface lo0 subinterface 0 admin-state enable
set / interface lo0 subinterface 0 ipv4 address 10.0.0.20/32

# PE1 connection
set / interface ethernet-1/1 admin-state enable
set / interface ethernet-1/1 subinterface 0 admin-state enable
set / interface ethernet-1/1 subinterface 0 ipv4 address 10.1.1.2/30
set / interface ethernet-1/1 subinterface 0 description "to-PE1"

# PE2 connection
set / interface ethernet-1/2 admin-state enable
set / interface ethernet-1/2 subinterface 0 admin-state enable
set / interface ethernet-1/2 subinterface 0 ipv4 address 10.1.1.6/30
set / interface ethernet-1/2 subinterface 0 description "to-PE2"

# PE3 connection
set / interface ethernet-1/3 admin-state enable
set / interface ethernet-1/3 subinterface 0 admin-state enable
set / interface ethernet-1/3 subinterface 0 ipv4 address 10.1.1.10/30
set / interface ethernet-1/3 subinterface 0 description "to-PE3"

# RR connection
set / interface ethernet-1/4 admin-state enable
set / interface ethernet-1/4 subinterface 0 admin-state enable
set / interface ethernet-1/4 subinterface 0 ipv4 address 10.1.3.1/30
set / interface ethernet-1/4 subinterface 0 description "to-RR1"

# ISIS for underlay
set / network-instance default protocols isis instance isis-main admin-state enable
set / network-instance default protocols isis instance isis-main level-capability L2
set / network-instance default protocols isis instance isis-main net [ 49.0001.0100.0000.0020.00 ]
set / network-instance default protocols isis instance isis-main interface ethernet-1/1.0 passive false
set / network-instance default protocols isis instance isis-main interface ethernet-1/2.0 passive false
set / network-instance default protocols isis instance isis-main interface ethernet-1/3.0 passive false
set / network-instance default protocols isis instance isis-main interface ethernet-1/4.0 passive false
set / network-instance default protocols isis instance isis-main interface lo0.0 passive true

# MPLS configuration (P router - no BGP needed)
set / network-instance default protocols mpls admin-state enable
set / network-instance default protocols mpls interface ethernet-1/1.0
set / network-instance default protocols mpls interface ethernet-1/2.0
set / network-instance default protocols mpls interface ethernet-1/3.0
set / network-instance default protocols mpls interface ethernet-1/4.0

# LDP
set / network-instance default protocols ldp admin-state enable
set / network-instance default protocols ldp router-id 10.0.0.20
set / network-instance default protocols ldp interface ethernet-1/1.0
set / network-instance default protocols ldp interface ethernet-1/2.0
set / network-instance default protocols ldp interface ethernet-1/3.0
set / network-instance default protocols ldp interface ethernet-1/4.0

# Enable NETCONF/gNMI for management
set / system management netconf-server admin-state enable
set / system management netconf-server network-instance mgmt
set / system management netconf-server source-address ::

set / system grpc-server admin-state enable
set / system grpc-server network-instance mgmt
set / system grpc-server source-address ::

commit save